async function fetchAndStoreJson(e,t){try{const o=await fetch(e),i=await o.json(),a=JSON.stringify(i);return localStorage.setItem(t,a),i}catch(e){}}async function fetchAndDisplayData(){try{await fetchAndStoreJson(gamesListPath,"gamesData"),await fetchAndStoreJson(usersListPath,"usersData");displayLastGames()}catch(e){}}function displayLastGames(){gamesData=JSON.parse(localStorage.getItem("gamesData")),gamesData.sort(((e,t)=>new Date(t.addeddate_videogame)-new Date(e.addeddate_videogame))),recentGames=gamesData.slice(0,6);const e=document.getElementById("list-items-template"),t=document.getElementById("list-items");recentGames.forEach((o=>{const i=document.importNode(e.content,!0);i.querySelector(".lastgames-items__last-items").setAttribute("id",`${o.id_videogame}`),i.querySelector(".lastgames-items__coverimage img").setAttribute("src",`./assets/${o.coverpic_videogame}`),i.querySelector(".lastgames-items__title h3").textContent=o.title_videogame,i.querySelector(".lastgames-items__subtitle h4").textContent=o.subtitle_videogame,i.querySelector(".lastgames-items__plateform img").setAttribute("src",`./assets/${o.plateform_videogame[1]}`),i.querySelector(".lastgames-maxitem__title h3").textContent=o.title_videogame,i.querySelector(".lastgames-maxitem__subtitle h4").textContent=o.subtitle_videogame,i.querySelector(".lastgames-maxitem__plateform p").textContent=o.plateform_videogame[0],i.querySelector(".lastgames-maxitem__year p").textContent=o.year_videogame,i.querySelector(".lastgames-maxitem__coverimage img").setAttribute("src",`./assets/${o.coverpic_videogame}`),i.querySelector(".lastgames-maxitem__editor p").textContent=o.editor_videogame,i.querySelector(".lastgames-maxitem__genre p").textContent=o.genre_videogame,i.querySelector(".lastgames-maxitem__country p").textContent=o.country_videogame,i.querySelector(".lastgames-maxitem__ref p").textContent=o.ref_videogame,i.querySelector(".lastgames-maxitem__support p").textContent=o.support_videogame,t.appendChild(i)}))}function toggleSubMenu(e){document.querySelector(`.submenu__container .${e.target.getAttribute("data-set")}`).classList.toggle("active"),reverseProfilArrow()}function closeSubMenu(){document.querySelector(".submenu__container .menu__ul--profil").classList.toggle("active")}function reverseProfilArrow(){document.getElementById("arrow-mobile").classList.toggle("down")}function displayFooterMenu(e){document.getElementById(e.target.getAttribute("data-set")).classList.toggle("active")}function reverseFooterArrow(e){e.target.classList.toggle("down")}async function insertPageContent(e,t,o){try{const i=await fetch(t+e);if(!i.ok)throw new Error(`Erreur de chargement de ${e}`);const a=await i.text();document.getElementById(o).innerHTML=a}catch(e){}}function deleteContainer(e){document.getElementById(e).textContent=""}function setFilterBar(){document.getElementById("filter-nav").classList.toggle("show")}function findUserGameByUserId(e){const t=JSON.parse(localStorage.getItem("usersData")).find((t=>t.id_user===e));if(t){return gamesData.filter((e=>t.games_user.includes(e.id_videogame)))}}function displayMyItemsView1(e,t){const o=document.getElementById(e),i=document.getElementById("list-items");t.forEach((e=>{const t=document.importNode(o.content,!0);t.querySelector(".view1-items__maincontainer").setAttribute("id",`${e.id_videogame}`),t.querySelector(".view1-items__coverimage img").setAttribute("src",`./assets/${e.coverpic_videogame}`),t.querySelector(".view1-items__title h3").textContent=e.title_videogame,t.querySelector(".view1-items__plateform img").setAttribute("src",`./assets/${e.plateform_videogame[1]}`),t.querySelector(".view1-maxitem__year p").textContent=e.year_videogame,t.querySelector(".view1-maxitem__editor p").textContent=e.editor_videogame,i.appendChild(t)}))}function displayMyItemsView2(e,t){const o=document.getElementById(e),i=document.getElementById("list-items");t.forEach((e=>{const t=document.importNode(o.content,!0);t.querySelector(".view2-item__maincontainer").setAttribute("id",`${e.id_videogame}`),t.querySelector(".view2-items__coverimage img").setAttribute("src",`./assets/${e.coverpic_videogame}`),t.querySelector(".view2-items__title h3").textContent=e.title_videogame,t.querySelector(".view2-items__subtitle h4").textContent=e.subtitle_videogame,t.querySelector(".view2-items__plateform p").textContent=e.plateform_videogame[0],t.querySelector(".view2-items__year p").textContent=e.year_videogame,t.querySelector(".view2-items__editor p").textContent=e.editor_videogame,i.appendChild(t)}))}function displayMyItemsView3(e,t){const o=document.getElementById(e),i=document.getElementById("list-items");t.forEach((e=>{const t=document.importNode(o.content,!0);t.querySelector(".view3-item__maincontainer").setAttribute("id",`${e.id_videogame}`),t.querySelector(".view3-items__title h3").textContent=e.title_videogame,t.querySelector(".view3-items__plateform p").textContent=e.plateform_videogame[0],t.querySelector(".view3-items__year p").textContent=e.year_videogame,t.querySelector(".view3-items__editor p").textContent=e.editor_videogame,i.appendChild(t)}))}function eraseTextareaContent(e){e.parentElement.firstElementChild.firstElementChild.value=""}function closeNotesContainer(e){e.nextElementSibling.classList.contains("hidden")||e.nextElementSibling.classList.add("hidden")}function displayGenre(){const e=JSON.parse(localStorage.getItem("gamesData")),t=JSON.parse(localStorage.getItem("usersData")),o=t.find((e=>1===e.id_user)).games_user,i={},a={};o.forEach((t=>{const o=e.find((e=>e.id_videogame===t));if(o){const e=o.genre_videogame;e in i?i[e]++:i[e]=1}})),e.forEach((e=>{const t=e.genre_videogame;t in a?a[t]++:a[t]=1}));const n=document.getElementById("genre_filter"),r=document.getElementById("genre_filter_template");for(const e in i){const t=document.importNode(r.content,!0);t.querySelector(".name_filter p").textContent=e,t.querySelector(".quantity_filter p").textContent=i[e]+" / "+(a[e]||0),n.appendChild(t)}}function displaySupport(){const e=JSON.parse(localStorage.getItem("gamesData")),t=JSON.parse(localStorage.getItem("usersData")),o=t.find((e=>1===e.id_user)).games_user,i={},a={};o.forEach((t=>{const o=e.find((e=>e.id_videogame===t));if(o){const e=o.support_videogame;e in i?i[e]++:i[e]=1}})),e.forEach((e=>{const t=e.support_videogame;t in a?a[t]++:a[t]=1}));const n=document.getElementById("support_filter"),r=document.getElementById("support_filter_template");for(const e in i){const t=document.importNode(r.content,!0);t.querySelector(".name_filter p").textContent=e,t.querySelector(".quantity_filter p").textContent=i[e]+" / "+(a[e]||0),n.appendChild(t)}}function displayPlateform(){const e=JSON.parse(localStorage.getItem("gamesData")),t=JSON.parse(localStorage.getItem("usersData")),o=t.find((e=>1===e.id_user)).games_user,i={},a={};o.forEach((t=>{const o=e.find((e=>e.id_videogame===t));if(o){const e=o.plateform_videogame[0];e in i?i[e]++:i[e]=1}})),e.forEach((e=>{const t=e.plateform_videogame[0];t in a?a[t]++:a[t]=1}));const n=document.getElementById("plateform_filter"),r=document.getElementById("plateform_filter_template");for(const e in i){const t=document.importNode(r.content,!0);t.querySelector(".name_filter p").textContent=e,t.querySelector(".quantity_filter p").textContent=i[e]+" / "+(a[e]||0),n.appendChild(t)}}